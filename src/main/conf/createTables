-- Create tables section ----------

-- Table USER

CREATE TABLE MRUSER
(
  ID BIGINT NOT NULL,
  NAME Varchar(128) NOT NULL,
  EMAIL Varchar(128) NOT NULL,
  PASSWORD Varchar(128) NOT NULL
);

ALTER TABLE MRUSER ADD PRIMARY KEY (ID);

-- Table MEETING_STATUS

CREATE TABLE MEETING_STATUS
(
  ID BIGINT NOT NULL,
  STATUS Varchar(20) NOT NULL,
  DESCRIPTION Text
);

ALTER TABLE MEETING_STATUS ADD PRIMARY KEY (ID);

-- Table ATTENDANT_STATUS

CREATE TABLE ATTENDANT_STATUS (

  ID BIGINT NOT NULL,
  STATUS Varchar(20) NOT NULL,
  ICON Text NOT NULL,
  DESCRIPTION Text
);

ALTER TABLE ATTENDANT_STATUS ADD PRIMARY KEY (ID);

-- Table meeting_schedule

CREATE TABLE meeting_schedule (

	ID BIGINT NOT NULL,
	recurrence_type VARCHAR(50) NOT NULL,
	description TEXT
);

ALTER TABLE meeting_schedule ADD PRIMARY KEY (ID);

-- Table MEETING

CREATE TABLE MEETING (

  ID BIGINT NOT NULL,
  ID_USER BIGINT NOT NULL,
  ID_MEETING_STATUS BIGINT NOT NULL,
  ID_MEETING_SCHEDULE BIGINT NOT NULL,
  ID_PARENT BIGINT,
  DATE TIMESTAMP(0) NOT NULL,
  SHORT_TITLE VARCHAR(30) NOT NULL,
  END_DATE DATE NOT NULL,
  PLACE Varchar(20) NOT NULL,
  DESCRIPTION Text,
  TOPIC Text
);

ALTER TABLE MEETING ADD PRIMARY KEY (ID);
ALTER TABLE MEETING ADD CONSTRAINT Relationship6 FOREIGN KEY (ID_MEETING_STATUS) REFERENCES MEETING_STATUS (ID) ON DELETE CASCADE ON UPDATE RESTRICT;
ALTER TABLE MEETING ADD CONSTRAINT Relationship1 FOREIGN KEY (ID_USER) REFERENCES MRUSER (ID) ON DELETE CASCADE ON UPDATE RESTRICT;
ALTER TABLE MEETING ADD CONSTRAINT Relationship30 FOREIGN KEY (ID_MEETING_SCHEDULE) REFERENCES MEETING_SCHEDULE (ID) ON DELETE CASCADE ON UPDATE RESTRICT;
ALTER TABLE meeting ALTER COLUMN ID SET DEFAULT nextval('meeting_seq');

CREATE TABLE ATTENDANT (

  ID BIGINT NOT NULL,
  ID_MEETING BIGINT NOT NULL,
  ID_ATTENDANT_STATUS BIGINT NOT NULL,
  ID_USER BIGINT NOT NULL

);

ALTER TABLE ATTENDANT ADD PRIMARY KEY (ID);
ALTER TABLE ATTENDANT ADD CONSTRAINT Relationship5 FOREIGN KEY (ID_ATTENDANT_STATUS ) REFERENCES ATTENDANT_STATUS (ID);
ALTER TABLE ATTENDANT ADD CONSTRAINT Relationship4 FOREIGN KEY (ID_MEETING) REFERENCES MEETING (ID) ON DELETE CASCADE ON UPDATE RESTRICT;
ALTER TABLE ATTENDANT ADD CONSTRAINT Relationship3 FOREIGN KEY (ID_USER) REFERENCES MRUSER (ID);
ALTER TABLE ATTENDANT ALTER COLUMN ID SET DEFAULT nextval('attendant_seq');